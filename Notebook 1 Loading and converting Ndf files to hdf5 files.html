

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Notebook 1 Loading and converting Ndf files to hdf5 files &mdash; pyecog_docs 0.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Notebook 2 Making a library" href="Notebook 2 Making a library.html" />
    <link rel="prev" title="Pyecog as a python module" href="Python notebooks.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pyecog_docs
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Site Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Installation.html">How to install Pyecog</a></li>
<li class="toctree-l1"><a class="reference internal" href="How to use the GUI.html">How to use the gui</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Python notebooks.html">Pyecog as a python module</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Python notebooks.html#jupyter-notebook-crash-course">Jupyter Notebook crash-course</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python notebooks.html#loading-the-pyecog-module">Loading the pyecog module</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="Python notebooks.html#example-jupyter-notebooks-for-classification-workflow">Example Jupyter notebooks for classification workflow</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Notebook 1 Loading and converting Ndf files to hdf5 files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Loading-the-pyecog-module">Loading the pyecog module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Converting-ndf-files-to-HDF5-format">Converting ndf files to HDF5 format</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Notebook 2 Making a library.html">Notebook 2 Making a library</a></li>
<li class="toctree-l3"><a class="reference internal" href="Notebook 3 Training a classifier from a library.html">Notebook 3 Training a classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="Notebook 4 Applying a classifier to a folder of h5 files.html">Notebook 4: Applying a classifier to a folder of h5 files</a></li>
<li class="toctree-l3"><a class="reference internal" href="Notebook 4 Applying a classifier to a folder of h5 files.html#Set-up-variables:">Set up variables:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Python notebooks.html#example-jupyter-notebooks-for-more-general-analysis">Example Jupyter notebooks for more general analysis</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyecog_docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="Python notebooks.html">Pyecog as a python module</a> &raquo;</li>
        
      <li>Notebook 1 Loading and converting Ndf files to hdf5 files</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Notebook 1 Loading and converting Ndf files to hdf5 files.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Notebook-1-Loading-and-converting-Ndf-files-to-hdf5-files">
<h1>Notebook 1 Loading and converting Ndf files to hdf5 files<a class="headerlink" href="#Notebook-1-Loading-and-converting-Ndf-files-to-hdf5-files" title="Permalink to this headline">¶</a></h1>
<p>In this notebook we go through converting .ndf files to .h5 files and
adding features to be used for classifiaction to them.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
<div class="section" id="Loading-the-pyecog-module">
<h2>Loading the pyecog module<a class="headerlink" href="#Loading-the-pyecog-module" title="Permalink to this headline">¶</a></h2>
<p>The easiest place in which to download and run this notebook is the
pyecog directory downloaded from github, e.g. “pyecog-Development” as
the pyecog module will be found in this folder. However, if you want to
run the notebook from elsewhere on your computer you first need to make
sure that python can find the pyecog module using sys.path.append(). To
do this modify and copy the following code into a cell and run it
(shift+enter).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pyecog_path</span> <span class="o">=</span> <span class="s1">&#39;/home/jonathan/git_repos/pyecog&#39;</span> <span class="c1"># replace this with the pyecog&#39;s location on your computer</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pyecog_path</span><span class="p">)</span>
</pre></div>
</div>
<p>If you are on windows you have to deal with the problem that backslashes
in your paths (when you copy them) are treated escape characters by
python. Prefixing the string with ‘r’ prevents this, as python creates a
“raw” string literal in which &nbsp;are treated as literal characters, not
escape characters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pyecog_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\home\jonathan\git_repos\pyecog&#39;</span>  <span class="c1"># replace this with the pyecog&#39;s location on your computer</span>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># note if you are in the directory downloaded from github you do not have to run this cell</span>
<span class="n">pyecog_path</span> <span class="o">=</span> <span class="s1">&#39;/home/jonathan/git_repos/pyecog&#39;</span>

<span class="c1"># e.g. if on a windows computer</span>
<span class="c1"># pyecog_path = r&#39;C:\Users\jonathan\Desktop\pyecog-Development&#39;</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pyecog_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># we can now inport pyecog and check it is located where we expect</span>
<span class="kn">import</span> <span class="nn">pyecog</span> <span class="k">as</span> <span class="nn">pg</span>

<span class="n">pg</span> <span class="c1"># check the module is imported from where you expect</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[3]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;module &#39;pyecog&#39; from &#39;/home/jonathan/git_repos/pyecog/pyecog/__init__.py&#39;&gt;
</pre></div>
</div>
</div>
<div class="section" id="Warnings-and-errors!">
<h3>Warnings and errors!<a class="headerlink" href="#Warnings-and-errors!" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>If you have an error message like:</li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ne">ImportError</span><span class="p">:</span> <span class="n">No</span> <span class="n">module</span> <span class="n">named</span> <span class="s1">&#39;pyecog&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">probably</span> <span class="n">means</span> <span class="n">you</span> <span class="n">haven</span><span class="s1">&#39;t set he &quot;pyecog_path&quot; variable correctly</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>If you have a different warning or error. Check you have activated
your pyecog environment before running jupyter notebook. On a windows
machine, in anaconda prompt:</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span> <span class="n">activate</span> <span class="n">pyecog_env</span> <span class="c1"># &quot;source activate pyecog&quot; for mac or linux</span>
<span class="o">&gt;&gt;</span> <span class="n">jupyter</span> <span class="n">notebook</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Converting-ndf-files-to-HDF5-format">
<h2>Converting ndf files to HDF5 format<a class="headerlink" href="#Converting-ndf-files-to-HDF5-format" title="Permalink to this headline">¶</a></h2>
<p>Insert blurb on hdf5 format. Two stages.</p>
<p>To begin we define variables for ndf and h5 folder paths.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ndf_folderpath</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;D:\2019\rat ivc\ndf\01_baseline_01&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ndf_filenames</span>  <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">ndf_folderpath</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ndf_filenames</span><span class="p">),</span> <span class="s1">&#39;.ndf files to convert to h5 file format&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-5-a7ae3e3e88a0&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>ndf_filenames  <span class="ansi-blue-fg">=</span> os<span class="ansi-blue-fg">.</span>listdir<span class="ansi-blue-fg">(</span>ndf_folderpath<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;Found&#39;</span><span class="ansi-blue-fg">,</span> len<span class="ansi-blue-fg">(</span>ndf_filenames<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;.ndf files to convert to h5 file format&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;D:\\2019\\rat ivc\\ndf\\01_baseline_01&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h5_folderpath</span>  <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;D:\2019\analysis pyecog\01_baselineconverted_01&#39;</span>

<span class="c1"># make folder for conversion if it doesnt already exist</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">h5_folderpath</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">h5_folderpath</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="1.-Convert-a-ndf-folder-to-h5-files">
<h3>1. Convert a ndf folder to h5 files<a class="headerlink" href="#1.-Convert-a-ndf-folder-to-h5-files" title="Permalink to this headline">¶</a></h3>
<p>Below we instatiate a DataHandler instance. Its
convert_ndf_directory_to_h5 method has the follwoing arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">ndf_dir</span> <span class="p">:</span> <span class="n">path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">directory</span> <span class="n">containing</span> <span class="n">ndf</span> <span class="n">files</span>
<span class="o">-</span> <span class="n">h5_dir</span>  <span class="p">:</span> <span class="n">path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">which</span> <span class="n">to</span> <span class="n">save</span> <span class="n">h5</span> <span class="n">files</span>
<span class="o">-</span> <span class="n">fs</span>      <span class="p">:</span> <span class="n">sampling</span> <span class="n">rate</span> <span class="n">per</span> <span class="n">second</span> <span class="o">-</span> <span class="nb">int</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="mi">256</span><span class="p">,</span><span class="mi">512</span><span class="p">,</span><span class="mi">1024</span><span class="p">,</span> <span class="ow">or</span> <span class="s1">&#39;auto&#39;</span> <span class="p">(</span><span class="ow">not</span> <span class="n">recommended</span><span class="p">)</span>
<span class="o">-</span> <span class="n">tids</span>    <span class="p">:</span> <span class="n">Transmitter</span> <span class="n">ids</span> <span class="n">to</span> <span class="n">convert</span><span class="o">.</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="ow">or</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">ids</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="p">[</span><span class="mi">88</span><span class="p">,</span><span class="mi">89</span><span class="p">,</span><span class="mi">92</span><span class="p">,</span><span class="mi">94</span><span class="p">]</span>
<span class="o">-</span> <span class="n">n_cores</span> <span class="p">:</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">cores</span> <span class="n">to</span> <span class="n">use</span> <span class="k">for</span> <span class="n">conversion</span><span class="o">.</span> <span class="n">Either</span> <span class="nb">int</span> <span class="ow">or</span> <span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="nb">all</span><span class="o">.</span>
<span class="o">-</span> <span class="n">glitch_detection</span> <span class="p">:</span> <span class="n">boolean</span> <span class="n">flag</span><span class="p">,</span> <span class="kc">True</span> <span class="ow">or</span> <span class="kc">False</span><span class="o">.</span> <span class="n">Specifies</span> <span class="n">whether</span> <span class="n">to</span> <span class="n">apply</span> <span class="n">glitch</span> <span class="n">detection</span><span class="o">.</span>
<span class="o">-</span> <span class="n">high_pass_filter</span> <span class="p">:</span> <span class="n">boolean</span> <span class="n">flag</span><span class="p">,</span> <span class="kc">True</span> <span class="ow">or</span> <span class="kc">False</span><span class="o">.</span> <span class="n">Specifies</span> <span class="n">whether</span> <span class="n">to</span> <span class="n">apply</span> <span class="n">a</span> <span class="mi">1</span> <span class="n">khz</span> <span class="n">high</span> <span class="k">pass</span> <span class="nb">filter</span><span class="o">.</span>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">handler</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">DataHandler</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sampling_freq</span> <span class="o">=</span> <span class="mi">512</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">handler</span><span class="o">.</span><span class="n">convert_ndf_directory_to_h5</span><span class="p">(</span><span class="n">ndf_dir</span>  <span class="o">=</span> <span class="n">ndf_folderpath</span><span class="p">,</span>
                                    <span class="n">save_dir</span> <span class="o">=</span> <span class="n">h5_folderpath</span><span class="p">,</span>
                                    <span class="n">fs</span>       <span class="o">=</span> <span class="n">sampling_freq</span><span class="p">,</span>
                                    <span class="n">tids</span>     <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span>  <span class="c1"># [1,2,4,6,9]</span>
                                    <span class="n">n_cores</span>  <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="c1"># -1 for all cores</span>
                                    <span class="n">glitch_detection</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">high_pass_filter</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-9-baa09b819f99&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span>                                     n_cores  <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">4</span><span class="ansi-blue-fg">,</span> <span class="ansi-red-fg"># -1 for all cores</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span>                                     glitch_detection<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">----&gt; 7</span><span class="ansi-red-fg">                                     high_pass_filter=True)
</span>
<span class="ansi-green-fg">~/git_repos/pyecog/pyecog/ndf/datahandler.py</span> in <span class="ansi-cyan-fg">convert_ndf_directory_to_h5</span><span class="ansi-blue-fg">(self, ndf_dir, tids, save_dir, n_cores, fs, glitch_detection, high_pass_filter, gui_object)</span>
<span class="ansi-green-intense-fg ansi-bold">    590</span>             gui_object <span class="ansi-blue-fg">=</span> gui_object
<span class="ansi-green-intense-fg ansi-bold">    591</span>
<span class="ansi-green-fg">--&gt; 592</span><span class="ansi-red-fg">         </span>files <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>f <span class="ansi-green-fg">for</span> f <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>fullpath_listdir<span class="ansi-blue-fg">(</span>ndf_dir<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> f<span class="ansi-blue-fg">.</span>endswith<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;.ndf&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    593</span>         <span class="ansi-green-fg">if</span> type<span class="ansi-blue-fg">(</span>tids<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">==</span><span class="ansi-blue-fg">&#39;tid&#39;</span><span class="ansi-blue-fg">:</span> tids <span class="ansi-blue-fg">=</span> tids<span class="ansi-blue-fg">.</span>strip<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39; &#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    594</span>

<span class="ansi-green-fg">~/git_repos/pyecog/pyecog/ndf/datahandler.py</span> in <span class="ansi-cyan-fg">fullpath_listdir</span><span class="ansi-blue-fg">(d)</span>
<span class="ansi-green-intense-fg ansi-bold">    560</span>     <span class="ansi-green-fg">def</span> fullpath_listdir<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    561</span>         <span class="ansi-blue-fg">&#39;&#39;&#39; returns full filepath,  excludes hidden files, starting with .&#39;&#39;&#39;</span>
<span class="ansi-green-fg">--&gt; 562</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">[</span>os<span class="ansi-blue-fg">.</span>path<span class="ansi-blue-fg">.</span>join<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> f <span class="ansi-green-fg">in</span> os<span class="ansi-blue-fg">.</span>listdir<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> f<span class="ansi-blue-fg">.</span>startswith<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;.&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    563</span>
<span class="ansi-green-intense-fg ansi-bold">    564</span>     def convert_ndf_directory_to_h5(self, ndf_dir,

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;D:\\2019\\rat ivc\\ndf\\01_baseline_01&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">h5_folderpath</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[10]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[]
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.-Add-features-to-h5-files-to-be-used-for-prediction">
<h3>2. Add features to h5 files to be used for prediction<a class="headerlink" href="#2.-Add-features-to-h5-files-to-be-used-for-prediction" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">h5py_folder</span>  <span class="p">:</span> <span class="n">path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">directory</span> <span class="n">containing</span> <span class="n">ndf</span> <span class="n">files</span>
<span class="o">-</span> <span class="n">n_cores</span>      <span class="p">:</span> <span class="n">number</span> <span class="n">of</span> <span class="n">cores</span> <span class="n">to</span> <span class="n">use</span> <span class="k">for</span> <span class="n">conversion</span><span class="o">.</span> <span class="n">Either</span> <span class="nb">int</span> <span class="ow">or</span> <span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="nb">all</span><span class="o">.</span>
<span class="o">-</span> <span class="n">timewindow</span>   <span class="p">:</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">seconds</span><span class="o">.</span> <span class="n">This</span> <span class="n">specifies</span> <span class="n">the</span> <span class="n">length</span> <span class="n">of</span> <span class="n">time</span> <span class="n">to</span> <span class="n">chunk</span> <span class="n">the</span> <span class="n">data</span><span class="o">.</span>
<span class="o">-</span> <span class="n">overwrite_features</span> <span class="p">:</span> <span class="n">boolean</span><span class="o">.</span> <span class="n">If</span> <span class="n">there</span> <span class="n">are</span> <span class="n">existing</span> <span class="n">features</span><span class="p">,</span> <span class="n">overwrite</span> <span class="n">them</span> <span class="ow">or</span> <span class="ow">not</span><span class="o">.</span>
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">handler</span><span class="o">.</span><span class="n">parallel_add_prediction_features</span><span class="p">(</span><span class="n">h5py_folder</span> <span class="o">=</span> <span class="n">h5_folderpath</span><span class="p">,</span>
                                         <span class="n">n_cores</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                         <span class="n">timewindow</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                         <span class="n">overwrite_features</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Adding features to transmitters in 0 h5 files in D:\2019\analysis pyecog\01_baselineconverted_01
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ZeroDivisionError</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-11-b2c9ed71c732&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span>                                          n_cores<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span>                                          timewindow<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">5</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">----&gt; 4</span><span class="ansi-red-fg">                                          overwrite_features=False)
</span>
<span class="ansi-green-fg">~/git_repos/pyecog/pyecog/ndf/datahandler.py</span> in <span class="ansi-cyan-fg">parallel_add_prediction_features</span><span class="ansi-blue-fg">(self, h5py_folder, n_cores, timewindow, overwrite_features, gui_object)</span>
<span class="ansi-green-intense-fg ansi-bold">    249</span>
<span class="ansi-green-intense-fg ansi-bold">    250</span>         print<span class="ansi-blue-fg">(</span> <span class="ansi-blue-fg">&#39;Adding features to transmitters in &#39;</span><span class="ansi-blue-fg">+</span>str<span class="ansi-blue-fg">(</span>l<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">+</span> <span class="ansi-blue-fg">&#39; h5 files in &#39;</span><span class="ansi-blue-fg">+</span> h5py_folder<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 251</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>printProgress<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span>l<span class="ansi-blue-fg">,</span> prefix <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#39;Progress:&#39;</span><span class="ansi-blue-fg">,</span> suffix <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#39;Complete&#39;</span><span class="ansi-blue-fg">,</span> barLength <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">50</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    252</span>         <span class="ansi-green-fg">for</span> i<span class="ansi-blue-fg">,</span> _ <span class="ansi-green-fg">in</span> enumerate<span class="ansi-blue-fg">(</span>pool<span class="ansi-blue-fg">.</span>imap<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>add_predicition_features_to_h5_file<span class="ansi-blue-fg">,</span> files_to_add_features<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    253</span>             self<span class="ansi-blue-fg">.</span>printProgress<span class="ansi-blue-fg">(</span>i<span class="ansi-blue-fg">,</span> l<span class="ansi-blue-fg">,</span> prefix <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#39;Progress:&#39;</span><span class="ansi-blue-fg">,</span> suffix <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#39;Complete&#39;</span><span class="ansi-blue-fg">,</span> barLength <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">50</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/git_repos/pyecog/pyecog/ndf/datahandler.py</span> in <span class="ansi-cyan-fg">printProgress</span><span class="ansi-blue-fg">(self, iteration, total, prefix, suffix, decimals, barLength)</span>
<span class="ansi-green-intense-fg ansi-bold">    729</span>         &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">    730</span>         str_format <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#34;{0:.&#34;</span> <span class="ansi-blue-fg">+</span> str<span class="ansi-blue-fg">(</span>decimals<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">+</span> <span class="ansi-blue-fg">&#34;f}&#34;</span>
<span class="ansi-green-fg">--&gt; 731</span><span class="ansi-red-fg">         </span>percents <span class="ansi-blue-fg">=</span> str_format<span class="ansi-blue-fg">.</span>format<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">100</span> <span class="ansi-blue-fg">*</span> <span class="ansi-blue-fg">(</span>iteration <span class="ansi-blue-fg">/</span> float<span class="ansi-blue-fg">(</span>total<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    732</span>         filled_length <span class="ansi-blue-fg">=</span> int<span class="ansi-blue-fg">(</span>round<span class="ansi-blue-fg">(</span>barLength <span class="ansi-blue-fg">*</span> iteration <span class="ansi-blue-fg">/</span> float<span class="ansi-blue-fg">(</span>total<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    733</span>         bar <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#39;*&#39;</span> <span class="ansi-blue-fg">*</span> filled_length <span class="ansi-blue-fg">+</span> <span class="ansi-blue-fg">&#39;-&#39;</span> <span class="ansi-blue-fg">*</span> <span class="ansi-blue-fg">(</span>barLength <span class="ansi-blue-fg">-</span> filled_length<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">ZeroDivisionError</span>: float division by zero
</pre></div></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Notebook 2 Making a library.html" class="btn btn-neutral float-right" title="Notebook 2 Making a library" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Python notebooks.html" class="btn btn-neutral" title="Pyecog as a python module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, J Cornford.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>